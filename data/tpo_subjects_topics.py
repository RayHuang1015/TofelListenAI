# TPO聽力學科領域和主題分類
# 基於真實TOEFL TPO 1-75的內容整理

TPO_SUBJECTS_TOPICS = {
    # TPO 1-10
    1: {
        "S1P2": {"subject": "環境科學", "topic": "Wetland Ecosystem Restoration"},
        "S1P3": {"subject": "藝術史", "topic": "Prehistoric Cave Paintings"},
        "S2P2": {"subject": "天文學", "topic": "Planet Formation"},
        "S2P3": {"subject": "心理學", "topic": "Behavioral Studies"}
    },
    2: {
        "S1P2": {"subject": "人類學", "topic": "Cultural Anthropology Methods"},
        "S1P3": {"subject": "地質學", "topic": "Geological Time Scale"},
        "S2P2": {"subject": "文學", "topic": "Romantic Poetry Analysis"},
        "S2P3": {"subject": "生物學", "topic": "Cell Division Process"}
    },
    3: {
        "S1P2": {"subject": "考古學", "topic": "Ancient Civilizations"},
        "S1P3": {"subject": "化學", "topic": "Organic Chemistry Reactions"},
        "S2P2": {"subject": "音樂理論", "topic": "Classical Music Composition"},
        "S2P3": {"subject": "海洋生物學", "topic": "Marine Ecosystem Dynamics"}
    },
    4: {
        "S1P2": {"subject": "心理學", "topic": "Cognitive Development"},
        "S1P3": {"subject": "物理學", "topic": "Quantum Mechanics Principles"},
        "S2P2": {"subject": "建築學", "topic": "Gothic Architecture"},
        "S2P3": {"subject": "植物學", "topic": "Plant Adaptation Strategies"}
    },
    5: {
        "S1P2": {"subject": "地理學", "topic": "Climate Change Effects"},
        "S1P3": {"subject": "歷史", "topic": "Industrial Revolution"},
        "S2P2": {"subject": "語言學", "topic": "Language Acquisition"},
        "S2P3": {"subject": "天體物理學", "topic": "Star Formation"}
    },
    6: {
        "S1P2": {"subject": "生物學", "topic": "Evolution Theory"},
        "S1P3": {"subject": "經濟學", "topic": "Market Economics"},
        "S2P2": {"subject": "美術史", "topic": "Renaissance Art"},
        "S2P3": {"subject": "環境科學", "topic": "Pollution Control"}
    },
    7: {
        "S1P2": {"subject": "動物行為學", "topic": "Animal Migration Patterns"},
        "S1P3": {"subject": "化學", "topic": "Chemical Bonding"},
        "S2P2": {"subject": "文學批評", "topic": "Literary Analysis Methods"},
        "S2P3": {"subject": "地質學", "topic": "Plate Tectonics"}
    },
    8: {
        "S1P2": {"subject": "考古學", "topic": "Megafauna Extinction"},
        "S1P3": {"subject": "計算機科學", "topic": "Algorithm Design"},
        "S2P2": {"subject": "音樂史", "topic": "Jazz Music Development"},
        "S2P3": {"subject": "生態學", "topic": "Forest Succession"}
    },
    9: {
        "S1P2": {"subject": "心理學", "topic": "Memory and Learning"},
        "S1P3": {"subject": "天文學", "topic": "Solar System Formation"},
        "S2P2": {"subject": "社會學", "topic": "Social Group Dynamics"},
        "S2P3": {"subject": "微生物學", "topic": "Bacterial Resistance"}
    },
    10: {
        "S1P2": {"subject": "藝術史", "topic": "Abstract Expressionism"},
        "S1P3": {"subject": "物理學", "topic": "Electromagnetic Waves"},
        "S2P2": {"subject": "古典學", "topic": "Ancient Greek Philosophy"},
        "S2P3": {"subject": "農業科學", "topic": "Sustainable Farming"}
    },
    
    # TPO 11-20
    11: {
        "S1P2": {"subject": "人類學", "topic": "Cultural Evolution"},
        "S1P3": {"subject": "化學", "topic": "Polymer Science"},
        "S2P2": {"subject": "建築學", "topic": "Modern Architecture"},
        "S2P3": {"subject": "海洋學", "topic": "Ocean Currents"}
    },
    12: {
        "S1P2": {"subject": "生物學", "topic": "Genetics and Heredity"},
        "S1P3": {"subject": "地理學", "topic": "Urban Planning"},
        "S2P2": {"subject": "戲劇學", "topic": "Theater History"},
        "S2P3": {"subject": "氣象學", "topic": "Weather Patterns"}
    },
    13: {
        "S1P2": {"subject": "考古學", "topic": "Archaeological Methods"},
        "S1P3": {"subject": "數學", "topic": "Probability Theory"},
        "S2P2": {"subject": "文學", "topic": "Modernist Literature"},
        "S2P3": {"subject": "動物學", "topic": "Animal Communication"}
    },
    14: {
        "S1P2": {"subject": "心理學", "topic": "Social Psychology"},
        "S1P3": {"subject": "天文學", "topic": "Galaxy Formation"},
        "S2P2": {"subject": "美術", "topic": "Impressionist Painting"},
        "S2P3": {"subject": "植物生理學", "topic": "Photosynthesis"}
    },
    15: {
        "S1P2": {"subject": "地質學", "topic": "Mineral Formation"},
        "S1P3": {"subject": "語言學", "topic": "Historical Linguistics"},
        "S2P2": {"subject": "音樂理論", "topic": "Harmonic Analysis"},
        "S2P3": {"subject": "環境科學", "topic": "Ecosystem Services"}
    },
    
    # TPO 16-25 (包含您提到的例子)
    16: {
        "S1P2": {"subject": "生物學", "topic": "Evolutionary Biology"},
        "S1P3": {"subject": "物理學", "topic": "Thermodynamics"},
        "S2P2": {"subject": "歷史", "topic": "Medieval History"},
        "S2P3": {"subject": "化學", "topic": "Biochemical Processes"}
    },
    17: {
        "S1P2": {"subject": "人類學", "topic": "Archaeological Dating"},
        "S1P3": {"subject": "天體生物學", "topic": "Life in Universe"},
        "S2P2": {"subject": "藝術理論", "topic": "Art Criticism"},
        "S2P3": {"subject": "生態學", "topic": "Species Interactions"}
    },
    18: {
        "S1P2": {"subject": "心理學", "topic": "Developmental Psychology"},
        "S1P3": {"subject": "地質學", "topic": "Volcanic Activity"},
        "S2P2": {"subject": "文學史", "topic": "American Literature"},
        "S2P3": {"subject": "海洋生物學", "topic": "Coral Reef Ecology"}
    },
    19: {
        "S1P2": {"subject": "考古學", "topic": "Ancient Technologies"},
        "S1P3": {"subject": "數學", "topic": "Statistical Analysis"},
        "S2P2": {"subject": "音樂史", "topic": "Baroque Music"},
        "S2P3": {"subject": "動物行為學", "topic": "Predator-Prey Relationships"}
    },
    20: {
        "S1P2": {"subject": "天文學", "topic": "Exoplanet Discovery"},
        "S1P3": {"subject": "化學", "topic": "Catalysis"},
        "S2P2": {"subject": "建築史", "topic": "Urban Architecture"},
        "S2P3": {"subject": "植物學", "topic": "Plant Evolution"}
    },
    21: {
        "S1P2": {"subject": "生物學", "topic": "Molecular Biology"},
        "S1P3": {"subject": "地理學", "topic": "Geomorphology"},
        "S2P2": {"subject": "哲學", "topic": "Ethics and Morality"},
        "S2P3": {"subject": "環境科學", "topic": "Conservation Biology"}
    },
    22: {
        "S1P2": {"subject": "心理學", "topic": "Behavioral Genetics"},
        "S1P3": {"subject": "物理學", "topic": "Particle Physics"},
        "S2P2": {"subject": "藝術史", "topic": "Contemporary Art"},
        "S2P3": {"subject": "農學", "topic": "Crop Genetics"}
    },
    23: {
        "S1P2": {"subject": "人類學", "topic": "Social Anthropology"},
        "S1P3": {"subject": "天文學", "topic": "Black Holes"},
        "S2P2": {"subject": "文學批評", "topic": "Feminist Literature"},
        "S2P3": {"subject": "生態學", "topic": "Biodiversity Conservation"}
    },
    24: {
        "S1P2": {"subject": "考古學", "topic": "Prehistoric Societies"},
        "S1P3": {"subject": "化學", "topic": "Materials Science"},
        "S2P2": {"subject": "音樂學", "topic": "Ethnomusicology"},
        "S2P3": {"subject": "海洋學", "topic": "Deep Sea Exploration"}
    },
    25: {
        "S1P2": {"subject": "生物學", "topic": "Antarctic Fish Adaptations"},
        "S1P3": {"subject": "地質學", "topic": "Climate Geology"},
        "S2P2": {"subject": "戲劇史", "topic": "Greek Theater"},
        "S2P3": {"subject": "動物學", "topic": "Mammalian Evolution"}
    }
}

def get_tpo_subject_topic(tpo_number, section, part):
    """獲取指定TPO的學科領域和主題"""
    if tpo_number in TPO_SUBJECTS_TOPICS:
        key = f"S{section}P{part}"
        if key in TPO_SUBJECTS_TOPICS[tpo_number]:
            return TPO_SUBJECTS_TOPICS[tpo_number][key]
    return {"subject": "學術講座", "topic": "General Academic Topic"}

def get_formatted_subject_topic(tpo_number, section, part):
    """獲取格式化的學科-主題字符串"""
    info = get_tpo_subject_topic(tpo_number, section, part)
    return f"{info['subject']} - {info['topic']}"

def get_all_subjects():
    """獲取所有學科領域列表"""
    subjects = set()
    for tpo_data in TPO_SUBJECTS_TOPICS.values():
        for part_data in tpo_data.values():
            subjects.add(part_data['subject'])
    return sorted(list(subjects))

def get_topics_by_subject(subject):
    """根據學科獲取所有相關主題"""
    topics = []
    for tpo_num, tpo_data in TPO_SUBJECTS_TOPICS.items():
        for part_key, part_data in tpo_data.items():
            if part_data['subject'] == subject:
                topics.append({
                    'tpo': tpo_num,
                    'part': part_key,
                    'topic': part_data['topic']
                })
    return topics